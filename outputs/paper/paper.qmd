---
title: "Accessing the COVID-19 Death Rate in the US: While It Varies Across Different Income Levels, the Impact of Political Preference is Unignorable"
title-block-banner: true
author: "Yiliu Cao"
thanks: "Code and data from this analysis are available at: https://github.com/yiliuc/COVID_US_county.git"
date: "today"
date-format: "long"
abstract: "This study utilizes the data on socio-economic factors, COVID-19 statistics, and election results sourced from the American Community Survey, the Center for Systems Science and Engineering (CSSE) at Johns Hopkins University, and Fox News. Primary findings indicate that the death rate increases as the voting for the Republican party rises, and the wealthier the county, the less the death number. While the Democratic Party favors the more affluent counties, the potential reason behind this is that people living in wealthier counties are more educated. Moreover, the prevalence of private insurance in these counties could be another factor contributing to fewer deaths. Future research should focus on more correlated variables, such as hospital capacity."
format: pdf
toc: true
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(here)
library(modelsummary)
library(gridExtra)
library(usmap)
library(knitr)
library(kableExtra)
library(purrr)
library(ggplot2)

acs <- read.csv(here("outputs/data/merged_data_acs.csv"))
acs_covid <- read.csv(here("outputs/data/merged_data_acs_covid.csv"))
data <- read.csv(here("outputs/data/merged_data_overall.csv"))
map_data <- read.csv(here("outputs/data/merged_data_overall.csv"))
election_data <- read.csv(here("outputs/data/election_data_clean.csv"))
data <- data %>%
  mutate(pctile = ntile(mean_household_income, 100),
         party = case_when(rep_win == 1 ~ "Republican",
                             rep_win == 0 ~ "Democratic",
                             TRUE ~ "A"),
         high_income = case_when(pctile > 50 ~ 1,
                                 TRUE ~ 0),
         age_85 = old_85,
         high_education = prop_higher_education,
         white = white_pct,
         black = black_pct) %>% 
  filter(state != "AK")
data_model <- data %>% 
  select(-county, -state, -total_population, -females, -fips, -cases, -deaths,
         -votes_rep, -votes_dem, -total_votes, -infection_rate, -mean_household_income, -old_65)

set.seed(0)
train_indices <- sample(1:nrow(data), 0.7 * nrow(data_model))

# Create the training set
training_data <- data_model[train_indices, ]

# Create the testing set
testing_data <- data_model[-train_indices, ]
```

# Introduction

On May 23rd, the WHO's Director-General, Dr. Tedros Adhanom Ghebreyesus, announced the end of the COVID-19 pandemic, declaring that the virus was no longer considered a global threat. This marked the official end of the pandemic that spanned three years. Over this period, nearly 7.6 billion people got infected, and approximately 6.9 million succumbed to the disease. The US seems to be one of the countries that have been influenced by COVID-19 the most, with about 1.1 million dead and 104 million infections. The mortality rate of COVID-19 in the US is about 3.41 per 1,000, which is significantly higher than in other western developed countries. Interestingly, the pandemic began around the time of the 2020 Federal Election and unfolded entirely during President Biden's term. As another Federal Election looms next year, it is worth knowing how the COVID deaths are related to socio-economic indicators. There's also speculation about the role of political preferences. Analyzing these connections could provide insights to better prepare for and prevent future health crises, especially as we navigate the post-pandemic period.

To understand and explore the COVID death rate, I will use five data sets from three different sources. American Community Survey [@acs] collects the socio-economic information for each county, such as the mean household income. The Center for Systems Science and Engineering (CSSE) at John Hopkins University [@jhu] presents data on COVID-19 cases and deaths by county. Regarding electoral data, Fox News have comprehensive records of the 2020 US Federal Election, providing the vote counts for each party across all counties. These data can help us to assess the inequality of mortality caused by COVID across different countries. 

My analysis will be focused on the variations of death rates across different counties to see how the counties with different socio-economic factors will affect the COVID-19 deaths. Moreover, I will incorporate a political dimension, especially the voting rate in support of the Republican party in each county, to see whether a higher proportion of Republican voters in a county correlates with the COVID-19 death rate. Through this paper, I aim to construct a model where the COVID-19 death rate is the dependent variable and includes only those predictors that are statistically significant. This study can help US citizens understand the factors affecting the death rate and inform their voting decisions in 2024.

There will be five main parts in this paper. In the [Data] part, I will introduce the data used in this paper and highlight the key variables. The [Methods] and [Results] parts will introduce the methods used in this paper and the corresponding results. Moreover, the results will be interpreted and provide insights about the COVID-19 death rate in the [Discussion] part. Lastly, I will conclude the entire paper and discuss the limitations and drawbacks.

# Data

As introduced in the introduction, there are three primary sources of data in the data: the American Community Survey (ACS) [@acs], The Center for Systems Science and Engineering (CSSE) at John Hopkins University [@jhu], and Fox News [@fox]. Each source provides distinct data dimensions that contribute to predicting the COVID-19 death rate in each US county.

## American Community Survey (ACS)

The data from ACS contains the socio-economic information for each county. While there are many tables from ACS, the three tables I will use in this paper are DP02, DP03, and DP05. All the tables are the 2021 five-year ACS estimates.

DP02 contains data regarding social characteristics. In this paper, I will extract information related to educational attainment, specifically focusing on the percentage of residents in each county who have attained at least a bachelor's degree. In contrast, DP03 contains information about the economic characteristics. I will take the information about the proportion of residents with private insurance, the mean household income, and the unemployment rate in each county. Lastly, DP05 contains the demographic data and housing estimates. In this paper, I will take the total population, the proportions of children and individuals above 85, and the percentages of white and black residents in each county. The @tbl-DP summarizes the important variables.

```{r}
#| echo: false
#| message: false
#| label: tbl-DP
#| tbl-cap: The summary of important variabls from ACS
data %>% 
  select(no_insurance, age_85, high_education) %>% 
  datasummary_skim(histogram = FALSE)
```

## Center for Systems Science and Engineering at JHU

The CSSE at JHU has been aggregating global COVID-19 data from 2020 to 2023 for each country in the world. All the raw data is readily accessible on their CSSE GitHub repository. Notably, they have provided daily COVID-19 reports for each US county since 2020. However, they stopped updating the data after March 9th, 2023, as there were no significant changes. The COVID data for the US used in the paper was collected on March 9th.

The data on March 9th contains the number of confirmed cases and deaths for each county in the US, as well as the incident rate. For the subsequent data analyses, I will only use the COVID cases and deaths in each county. The @tbl-covid summarized them.

```{r}
#| echo: false
#| message: false
#| label: tbl-covid
#| tbl-cap: The summary of infection and death rate of COVID in US
data %>% 
  select(infection_rate, death_rate) %>% 
  datasummary_skim(histogram = FALSE)
```

### Fox News

Fox News has posted the 2020 Election data, which was collected by Tony McGovern [@mcgovern]. It contains the county-level election results during the 2020 Federal Election. For each county, it includes the number of votes for the demographic and republican party, as well as the total votes.

## Data Cleaning

All data was collected and cleaned using the statistical programming language `R` [@R]. The packages used are `tidyverse` [@tidyverse], `dplyr` [@dplyr], `stringr` [@stringr], and `janitor` [@janitor]. Besides, `here` [@here], `modelsummary` [@modelsummary], `girdExtra` [@gridExtra], `usmap` [@usmap], `ggpot2` [@ggplot2], `knitr` [@knitr], `kableExtra` [@kableExtra] are used to analyze the data.

The way to clean each data set is different. For all the ACS data, I downloaded them using ACS API [@acs_api] and only extracted the necessary variables using the codebook published by ACS [@acs_codebook]. Additionally, I standardized the county names and transformed state names into their abbreviated forms. Regarding the COVID data sourced from JHU, I only select the cases and death numbers of US counties. Lastly, for the election data, I not only extracted the county name and transformed the state name to its abbreviation form but also calculated the number of people voting for the Republican party per 1000 voters.

After cleaning each data set, I merge the five data sets by county and state. Based on the merged data set, I calculate the infection and death number per 1000 residents in each county. Therefore, each row in the merged data represents a US county and provides demographic information such as the total population. In addition, the data also contains the voting pattern in each county. The @tbl-summary_variables summarizes all the important variables in this paper.

```{r}
#| echo: false
#| message: false
#| label: tbl-summary_variables
#| tbl-cap: Summary of important variables in the model
data.frame(variable = c("High education attainment",
                        "Income Percentile",
                        "People with no insurance",
                        "People with private insurance",
                        "Males",
                        "People aged above 85",
                        "White people",
                        "Black people",
                        "People supporting Republican"),
           coded_name = c("high_education",
                          "IncomePctile",
                          "no_insurance",
                          "private_insurance",
                          "males",
                          "age_85",
                          "white",
                          "black",
                          "rep_rate"),
           description = c("The proportion of local residents with at least Bachelor degree",
                           "The mean household income percentile representing the income level for each county",
                           "The proportion of local residents without insurance",
                           "The proportion of local residents with private insurance",
                           "The proportion of male residents",
                           "The proportion of people aged above 85",
                           "The proportion of white people",
                           "The proportion of black people",
                           "Number of voters supporting Republican by 1000")) %>% 
  rename(`Variable` = variable,
         `Encoded Name` = coded_name,
         `Description` = description) %>% 
  kable(booktabs = TRUE) %>% 
  column_spec(column = 3, width = "6cm")
```


```{r}
#| echo: false
#| message: false
#| label: fig-boxplot
#| fig-cap: Summary of deaths rate for counties voting for Democratic and Republican
data  %>%
  ggplot(mapping = aes(x = party, y = death_rate)) +
  geom_boxplot() +
  theme_minimal() +
  labs(x = "Voting Party",
       y = "Death Rate per 1000")
```

To understand the data clearly, @fig-boxplot presents the distribution of death rates for counties based on their voting preference for the two major parties. It seems that political preference corresponds with variations in death rates. Specifically, counties that leaned Republican exhibited a relatively higher death rate compared to those favoring the Democratic party. Notably, outliers are present in both groups.

```{r plot-chunk, fig.width=8, fig.height=6, out.width="100%"}
#| echo: false
#| warning: false
#| message: false
#| label: fig-map
#| fig-cap: Election results of 2020 Federal Election and the corresponding death rate for each US county
state_boundaries <- usmap::us_map(regions = "states", 
                                  exclude = c("AK", "Hawaii"))
plot1 <- plot_usmap(data = data, values = "rep_rate", regions = "counties", exclude = c("AK", "Hawaii")) + 
  scale_fill_gradient2(name = "Voting for the Republican %", 
                       low = "blue", mid = "white", high = "red",
                       midpoint = 500, 
                       breaks = c(0, 500, 1000)) + 
  geom_polygon(data = state_boundaries, 
               aes(x = x, y = y, group = group), 
               fill = NA, 
               color = "black", size = 0.8) +  
  labs(subtitle = "The voting patter for each US county") +
  theme(plot.subtitle = element_text(size = 12,
                                     hjust = 0.5),
        legend.position = "right", plot.title = element_blank())

plot2 <- plot_usmap(data = data, values = "death_rate", regions = "counties", exclude = c("AK", "Hawaii")) + 
  scale_fill_gradient2(low = "white", high = "blue", 
                        limits = c(0, 8),
                        breaks = c(0, 8),
                        name = "Death per 1000",
                       oob = scales::squish) + 
  geom_polygon(data = state_boundaries, 
               aes(x = x, y = y, group = group), 
               fill = NA, 
               color = "black", size = 0.8) +  
  labs(subtitle = "Death of COVID per 1000 ") +
  theme(plot.subtitle = element_text(size = 12,
                                     hjust = 0.5),
        legend.position = "right", plot.title = element_blank())

# Arrange the plots vertically with a main title
library(cowplot)

plot_grid(plot1, plot2, ncol = 1, align = "v", rel_heights = c(1,1))
```

To better understand the distribution of death rate from a geography perspective, @fig-map compares the support for Republicans with the corresponding death rate by plotting them onto maps. From the graph, we can observe that the dark color corresponds to the dark blue, meaning that the counties voting for the Republican seem to have a higher death rate than those voting for the Democratic Party. This pattern is especially significant for the central states.

## Data limitations

Our data combines five data sets from three sources. Nonetheless, there are still limitations that could influence our results, potentially reducing the accuracy of our predictions.

First, there is a lack of COVID information in certain states, especially in "Utah." This can be observed from @fig-map, where the counties are grey, indicating the data for this county is missing. Due to this lack of one data set, the merged data set will also lack information on these counties. The accuracy of the subsequent analyses may also be decreased.

# Methods

As I introduced, this paper aims to predict the death rate of COVID in each country of the US and to detect whether this correlation is related to their political preferences. Based on the merged data above, I will perform a series of models, from simple to complicated, to detect which predictors are significant in predicting the death rate.

## Model Specifics

Before we fit the models, I will split the data into training and testing data. The training data is used to fit all the models, and they are tested on the testing model to see which one performs better.

In each OLS regression model, the dependent variable will consistently be the COVID-19 death rate for each county. Given that death rates can be influenced by many factors, including demographics and economics, and given our interest in the potential impact of political party affiliation from the last Federal Election, I will establish two sets of models. The first set will not incorporate political preferences, while the second set will. Within each of these sets, there will be three models, each focusing exclusively on one category of predictors. Additionally, there will be a comprehensive model encompassing all predictors and a best-fit model determined by $R^2_{adj}$ and $RMSE$. In total, this approach will yield ten models, including the two best-fit models. To decide which model is the best, I will evaluate them using testing data to see which one has a lower testing $RMSE$.

The general form of the regression models is 
$$Y=\beta_0+\beta_1 X_1+\cdots+\beta_p X_p+\epsilon$$
where - $Y$ represents the response variables, which is the death rate. - $\beta_0$ represents the intercept, which is the death rate holding all variables to zero - $\beta_j$ represents the change of death rates with one unit increase in $X_j$ - $\epsilon$ captures measurement errors and other discrepancies

## Assumptions of the regression models

After we fit the linear regression models, it is essential to check the assumptions to ensure the accuracy of our predictions. There are four main assumptions, which are linearity, uncorrelated error, constant variance, and normality. In this paper, I will assume the models satisfy both of the four assumptions.

## Expected MSE and Bias-Variance Trade-off

The rationale for partitioning the data into training and testing sets is to validate our model. That said, by training a model using training data and then evaluating it using test data, we can determine which model produces the lowest expected MSE and better performance.

$$
\mathbb{E}\left[(Y-\hat{f}(x))^2 \mid X=x\right]=\operatorname{Var}(\hat{f}(x))+(\mathbb{E}[\hat{f}(x)]-f(x))^2+\sigma^2
$$
The above equation shows the expected MSE, which underscores the bias-variance trade-off. It tells us the trade-off between the model's complexity and the interpretability. An intricate model may increase the bias, but its variance will be higher if we vary the data, and vice-versa.

Hence, by evaluating our models using the testing data, we can know whether we should fit a relatively simple or complicated model.

# Results

## Model Excluding Political Preferences

```{r}
#| echo: false
#| message: false
#| label: tbl-first_model
#| tbl-cap: Summary of the Best Model Without Politics Preference 

# Creating the Model
best1 <- lm(death_rate ~ high_education + pctile + no_insurance + private_insurance + males + age_85 + white + black, data = training_data)

broom::tidy(best1) %>% 
  mutate(predictors = c("(Intercept)", as.character(attr(terms(best1), "term.labels"))),
         estimate = round(estimate, 3),
         std.error = round(std.error, 3),
         statistic = round(statistic, 3),
         p.value = round(p.value, 3)) %>% 
  select(predictors,
         estimate,
         std.error,
         statistic,
         p.value) %>% 
  rename(`Predictor` = predictors,
         `Estimate` = estimate,
         `Standard Error` = std.error,
         `Statistics` = statistic,
         `P-value` = p.value) %>% 
  kable(booktabs = TRUE)
```

@tbl-first_model shows the summary table for the model without political references. Using the above information, we can write the equation model:

```{=tex}
\begin{align*}
\text{Death Rate} &=  7.521 \\
& - 0.051 \times \text{prop\_higher\_education} \\
& - 0.012 \times \text{IncomePctile} \\
& + 0.066 \times \text{no\_insurance} \\
& - 0.014 \times \text{private\_insurance} \\
& - 0.055 \times \text{males} \\
& + 0.303 \times \text{old\_85} \\
& + 0.011 \times \text{white\_pct} \\
& + 0.013 \times \text{black\_pct}
\end{align*}
```

The above equation shows the model excluding the political preferences. When all variables are set to zero, the anticipated death rate stands at approximately 7.2 per 1,000. Keeping other variables constant, an increase of one percent in the proportion of individuals having at least a bachelor's degree is associated with an expected rise of 0.05 in the death rate. Furthermore, for every percentile increase in income, the death rate is projected to drop by 0.02. Notably, there's a negative correlation between the proportion of uninsured individuals and the death rate; an uptick of 10% in the ratio of uninsured residents in a county may lead to an additional 0.7 deaths per 1,000.

Regarding demographic factors, the number of deaths is inversely correlated with the number of males in a county. One percent increase in the males will result in 0.06 less death. Moreover, it seems that older people are more likely to die from COVID. That said, there will be 0.29 more deaths if there is a one percent increase in the proportion of people aged above 85. Lastly, one percent increase in the proportion of white and black people is expected to have 0.01 more deaths.

## Model Including Plotical Preference

```{r}
#| echo: false
#| message: false
#| label: tbl-second_model
#| tbl-cap: Summary of the Best Model With Politics Preference 

# Creating the Model
best2 <- lm(death_rate ~ rep_rate + high_education + pctile + 
                 private_insurance  + no_insurance +
                 males + age_85  + white + 
                 black, data = training_data)

broom::tidy(best2) %>% 
  mutate(predictors = c("(Intercept)", as.character(attr(terms(best2), "term.labels"))),
         estimate = round(estimate, 3),
         std.error = round(std.error, 3),
         statistic = round(statistic, 3),
         p.value = round(p.value, 3)) %>% 
  select(predictors,
         estimate,
         std.error,
         statistic,
         p.value) %>% 
  rename(`Predictor` = predictors,
         `Estimate` = estimate,
         `Standard Error` = std.error,
         `Statistics` = statistic,
         `P-value` = p.value) %>% 
  kable(booktabs = TRUE)
```

@tbl-second_model shows the summary of the best model without and with the political preferences. Based on them, we can write the regression question.

```{=tex}
\begin{align*}
\text{Death Rate} &=  7.596 \\
& + 0.003 \times \text{Rep\_Rate} \\
& - 0.024 \times \text{High\_Education} \\
& - 0.010 \times \text{Pctile} \\
& + 0.027 \times \text{No\_Insurance} \\
& - 0.028 \times \text{Private\_Insurance} \\
& - 0.059 \times \text{Males} \\
& + 0.308 \times \text{Age\_85} \\
& - 0.008 \times \text{White} \\
& + 0.013 \times \text{Black}
\end{align*}
```

The difference between the second and the first model is that the second model includes the political preference for each county as one predictor to predict the death rate due to COVID-19. Holding other variables, we can see that for every 100 more votes per 1000 for the Republican party, 0.3 more people are expected to die.

## Comparing the testing error

The above two models are fitted using the training data. Comparing the training RMSE from @tbl-all_models_1 and @tbl-all_models_2, we can find that the model containing the political preference has a lower training RMSE. As introduced in the Methods part, to test the prediction performance of the models, I will calculate the test error for the two models to see which is better.

```{r}
#| echo: false
#| message: false
#| label: tbl-test_error
#| tbl-cap: The testing error of the above two models

calculate_testing_error <- function(model, testing_data, outcome) {
  # Predict the outcomes on the testing data
  predictions <- predict(model, newdata = testing_data)
  
  # Compute the residuals
  residuals <- predictions - testing_data[[outcome]]
  
  # Compute the MSE
  mse <- mean(residuals^2)
  
  return(mse)
}

data.frame(model = c("Model 1", "Model 2"),
           error = c(calculate_testing_error(best1, testing_data, "death_rate"),
                     calculate_testing_error(best2, testing_data, "death_rate"))) %>% 
  rename(`Model` = model,
         `Testinf Error` = error) %>% 
  kable(booktabs = TRUE)
```

@tbl-test_error shows the testing error of the above two models. We can observe that the errors for the two models are 1.769733 and 1.675969. Therefore, the model containing the political preferences has a lower testing MSE; it has better predictions than the another one.

# Discussion

To sum up, the second model which contains the political reference is more appropriate than another one, representing that the party each county supported during the last election may change the attitude that people face with COVID and hence results differences in death rate. In addition to that, it is also important to consider the rest variables while predicting the death rate.

## Although income levels are known to affect the COVID mortality, the impact of political preferences is more substantial than anticipated, potentially overcshadowing the effects of income.

From the @tbl-second_model, we can observe that both income percentile and the support of Republican both are significant in predicting the death rate of COVID, but with an inverse direction of their coefficients. More people voting for Republican party is expected to increase the number of deaths due to COVID in this county and a wealthier counties usually have a less COVID deaths. However, if we compare their values of coefficients, we can find that the increase in death by every three more people in 1000 voting for Republican party is equivalent to decrease in death rate by one increase in the income percentile. In other words, counties with the lowest income levels might be the worst areas sacrificing from COVID if they support the Republican party.

```{r, fig.width=10, fig.height=4}
#| echo: false
#| message: false
#| label: fig-income_state
#| fig-cap: Variation in COVID-19 Mortality Rates Across States, Categorized by Income Levels and Dominant Political Preferences

library(dplyr)
library(ggplot2)
# Find the wining data for each state
data_win_party <- data %>%
  group_by(state) %>%
  summarise(dem_votes = sum(votes_dem),
            rep_votes = sum(votes_rep), 
            .groups = 'drop') %>% 
  mutate(winning_party = ifelse(dem_votes > rep_votes, 'Democratic', 'Republican')) %>% 
  select(state, winning_party)
# Calculate the average income
average_income_by_state <- data %>%
  group_by(state) %>%
  summarise(average_income = mean(mean_household_income), .groups = 'drop')
# Join the winning party and average income back to the original data
data_win_party_income <- data %>%
  left_join(data_win_party, by = "state") %>%
  left_join(average_income_by_state, by = "state")
# Arrange states by average income
ordered_states <- data_win_party_income %>%
  arrange(average_income) %>%
  .$state %>%
  unique()
# Create a factor with levels based on income-ordered states for plotting
data_win_party_income$state <- factor(data_win_party_income$state, levels = ordered_states)

average_death_rate <- mean(data_win_party_income$death_rate)

ggplot(data_win_party_income, aes(x = state, y = death_rate, fill = winning_party)) +
  geom_boxplot() +
  geom_hline(yintercept = average_death_rate, linetype = "dashed", color = "black") +
  annotate("text", x = Inf, y = average_death_rate, label = " National Average", hjust = 1, vjust = -0.5, color = "black", size = 3) +

  # Adding the dashed line
  scale_fill_manual(values = c('Democratic' = 'blue', 'Republican' = 'red')) +
  labs(y = 'Death Rate', x = 'State (Ascending Income)', fill = "Winning Party") +
  theme_minimal() +
  theme(legend.position = "bottom") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

@fig-income_state can prove our point. The @fig-income_state shows the spread of COVID death rate for each state in the order of ascend income levels. The color represent the party each state supported during 2020 US Federal Election. We can observe that twelve out of the top 15 poorest counties voted for Donald Trump. In contrast, only one of the top 15 richest states voted for the Republican Party. In terms of the death rate, the @fig-income_state also shows that the death rate decreases as income level increases and majority of counties voting for Democratic party has a death rate lower than the national average level.

```{r}
#| echo: false
#| message: false
library(dplyr)
library(ggplot2)

# Assuming 'data' is your DataFrame with columns: pctile, rep_rate, dem_rate

# Step 1: Calculate the average support rate for each party at each income percentile
avg_support <- data %>%
  group_by(pctile) %>%
  summarise(
    avg_rep_rate = mean(rep_rate),
    avg_dem_rate = mean(dem_rate)
  ) %>%
  ungroup()

# Step 2: Divide income percentile into four groups
avg_support <- avg_support %>%
  mutate(
    pctile_group = cut(pctile, breaks = quantile(pctile, probs = 0:4/4), include.lowest = TRUE)
  )

# Step 3: Fit regression models and predict values for each piece (this is a placeholder)
# You would fit your piece-wise regression models here for each party and each group

# Plotting with placeholder regression lines (You'll need the actual fitted model predictions)
ggplot(avg_support, aes(x = pctile)) +
  geom_point(aes(y = avg_rep_rate), color = 'red') +
  geom_point(aes(y = avg_dem_rate), color = 'blue') +
  # Placeholder for regression lines
  geom_smooth(data = subset(avg_support, pctile_group == 1), aes(y = avg_rep_rate, color = "Republican"), method = "lm", se = FALSE) +
  geom_smooth(data = subset(avg_support, pctile_group == 1), aes(y = avg_dem_rate, color = "Democrat"), method = "lm", se = FALSE) +
  # ... repeat geom_smooth for other groups ...
  scale_color_manual(values = c("Republican" = "red", "Democrat" = "blue")) +
  labs(title = 'Average Support Rate by Income Percentile',
       x = 'Income Percentile', y = 'Average Support Rate') +
  theme_minimal() +
  theme(legend.position = "bottom")

# Note: In a real scenario, you would repeat the geom_smooth for the other pctile_groups (2, 3, 4)
# and would use the actual fitted model predictions.

```

This is a surprising but also horrible observation as Donald Trump is especially in favor of poor people. This means the low-income voters voting for Trump increase their chances of death in disguised form. Based on the fact that the death of COVID of low-income people is almost two times higher than the high-income [citation], it seems that it is not unfair to attribute the high death rate of US to Republican Party (Donald Trump).

## The difference in high-education atteinment and insurance structure may be potential factors causing the above phenomenon.

The model [@tbl-second_model] incorporates the proportion of people that have at least bachelor degree, and the proportion of people with private insurance or without insurance. In terms of education level, there is an inverse relationship between the death rate and the number of residents with high education level. Its coefficient value is relatively high, the death number can be decreased by 0.24 if there are ten more percent people having higher degree.  

```{r}
#| echo: false
#| message: false
#| label: fig-income_education
#| fig-cap: The change of average death rate across different education levels
summarized_data <- data %>%
  mutate(bin = cut(pctile, breaks = seq(0, 100, by = 5), include.lowest = TRUE, labels = seq(2.5, 97.5, by = 5))) %>%
  group_by(bin) %>%
  summarise(
    avg_death_rate = mean(death_rate, na.rm = TRUE),
    avg_education_prop = mean(high_education, na.rm = TRUE)
  )

# Create the plot with dual y-axis
# Create the plot with dual y-axis
ggplot(summarized_data, aes(x = as.numeric(as.character(bin)))) +
  geom_line(aes(y = avg_death_rate, color = "Avg. Death Rate"), size = 1) +
  geom_line(aes(y = avg_education_prop/5, color = "Avg. High-Education Rates"), size = 1) + 
  scale_y_continuous(sec.axis = sec_axis(~.*5, name = "Avg. High-Education Rates")) + 
  labs(x = "Income Percentile", y = "Avg. Death Rate", color = "Indicators") +
  theme_minimal() +
  theme(legend.position = "bottom") 
```

@fig-income_education shows the average death rate across different income percentile and the corresponding average high-education levels. The blue line represents the average high-education rates and the red line is the average death rate, corresponding to different y-axis. From the graph, it verifies our conclusion which the average death rate decreases as income percentile increases. Meanwhile, the proportion of people with at least bachelor degree goes higher. 

Therefore, one reason can explain the inequality of COVID mortality is that there are less people with higher degree lives in the low-income county. High educational level people are more willing to live at the wealthier counties. They are more educated and perhaps they know what Trump did was wrong and hence they did not vote for Trump. This can also explain why there are less votes for Trump in wealthier counties/states.

In addition to education level, the healthcare insurance is also significant in predicting the death rate for each county. Based on @tbl-second_model, it seems that both `no_insurance` and `private_insurance` are also significant in predicting the death rate for each county but they shows an inverse relationship on the death rate. In addition, the values of these two coefficients are almost same, meaning that the effects on death rate between them can be offset.

```{r}
#| echo: false
#| message: false
#| label: fig-income_insurance
#| fig-cap: The change of average death rate across different education levels
# Update the summarized_data to include the new averages
summarized_data <- data %>%
  mutate(bin = cut(pctile, breaks = seq(0, 100, by = 5), include.lowest = TRUE, labels = seq(2.5, 97.5, by = 5))) %>%
  group_by(bin) %>%
  summarise(
    avg_death_rate = mean(death_rate, na.rm = TRUE),
    avg_no_insurance = mean(no_insurance, na.rm = TRUE),
    avg_private_insurance = mean(private_insurance, na.rm = TRUE)
  )

# Create the plot with dual y-axis
ggplot(summarized_data, aes(x = as.numeric(as.character(bin)))) +
  geom_line(aes(y = avg_death_rate, color = "Avg. Death Rate"), size = 1) +
  geom_line(aes(y = avg_no_insurance/8, color = "Avg. No Insurance Rates"), size = 1) +
  geom_line(aes(y = avg_private_insurance/8, color = "Avg. Private Insurance Rates"), size = 1) + 
  scale_y_continuous(sec.axis = sec_axis(~.*8, name = "No/Private Insurance Rates")) + 
  labs(x = "Income Percentile", y = "Avg. Death Rate", color = "Indicators") +
  theme_minimal() +
  theme(legend.position = "bottom")
```

@fig-income_insurance shows the proportion of people with no/private insurance at each level of income. Unsurprisingly, as income percentiles increases, the proportion of people with private insurance increases but people with no insurances decreases. This suggest that the insurance can be crucial during the pandemic period. People with insurance, especially private insurance may be more likely to have medicine or vaccines, hence the counties with more people having insurance are relatively lower compared to the counties which less people having insurance. In addition, the private insurance seems to have more significant effects.

Comparing education with insurance, one common thing is that the we can see diverging trends in poorer and wealthier counties. People living in wealthier counties are more educated and concerns more about the public issue. Meanwhile, their awareness of protecting themselves from COVID is stronger than the poorer people. Due to their wealth level, they have the money to purchase private insurance and are more accessible to the medicines or vaccines. This explains why the wealthier counties had a relatively lower COVID mortality rate than poor ones.

# Conclusion

This paper looks back on the past three years of the epidemic utilizing the socio-economic, COVID and election data in US to see how the COVID death rate varies across counties in US. By the paper, I found that the county's political preference seems to be affect its death rate. Low-income people seems to make "stupid" decision, which they vote for the Republican party which brings them more deaths. In contrast, people living in the wealthier counties seems to be more smart, perhaps they are more educated.

## Weaknesses

This paper has several limitations. First of all, the data of COVID and election are lost for certain counties, especially the counties in Utah. In addition, I assumes the models do not have any violations on its assumptions. Both drawback may result in inaccurate predictions and lead to the bad performance of the model.

## Future research
For the future research, one primary thing to do is to use a more complicated model such as Multilevel with Post-Stratification (MR.P). In addition, it would also be necessary to delve deeper into other factors that may affect the COVID death rate such as the healthcare capacity in each county.

\newpage

# Appendix {.unnumbered}

## Model details

```{r}
#| echo: false
#| message: false
#| label: tbl-all_models_1
#| tbl-cap: Summary of the set of models with political preferences

# data_model$mean_household_income <- log(data_model$mean_household_income)

social1 <- lm(death_rate ~ high_education, data = training_data)
economic1 <- lm(death_rate ~ pctile + unemployment + no_insurance +
                             private_insurance + public_insurance, 
                data = training_data)
demographic1 <- lm(death_rate ~ males + age_85 + children +
                                white + black, data = training_data)
overall1 <- lm(death_rate ~ .-rep_win - party - rep_rate - high_income, data = training_data)
best1 <- lm(death_rate ~ high_education + pctile + no_insurance + private_insurance + males + age_85 + white + black, data = training_data)
modelsummary(list(social1, economic1, demographic1, overall1, best1), stars=TRUE)
```

```{r}
#| echo: false
#| message: false
#| label: tbl-all_models2
#| tbl-cap: Summary of the set of models with political preferences

social2 <- lm(death_rate ~ rep_rate + high_education, data = training_data)
economic2 <- lm(death_rate ~ rep_rate + pctile + unemployment + no_insurance +
                             private_insurance + public_insurance, 
                data = training_data)
demographic2 <- lm(death_rate ~ rep_rate + males + age_85 + children +
                                white + black, data = training_data)
overall2 <- lm(death_rate ~ rep_rate + high_education + pctile + 
                 unemployment + private_insurance + public_insurance + no_insurance +
                 males + age_85 + children + white + 
                 black, data = training_data)
best2 <- lm(death_rate ~ rep_rate + high_education + pctile + 
                 private_insurance  + no_insurance +
                 males + age_85  + white + 
                 black, data = training_data)
modelsummary(list(social2, economic2, demographic2, overall2, best2), stars=TRUE)
```

\newpage

# References {.unnumbered}

https://news.un.org/en/story/2023/05/1136367 https://www.aljazeera.com/news/2023/5/11/three-years-1-1-million-deaths-covid-emergency-ending-in-us
https://wisevoter.com/state-rankings/poorest-states/

https://github.com/tonmcg/US_County_Level_Election_Results_08-20

https://www.reuters.com/world/us/us-poor-died-much-higher-rate-covid-than-rich-report-2022-04-04/